<!-- Miniatures -->
<% show_thumbnails = local_assigns[:show_thumbnails] || false %>
<% carousel_id = local_assigns[:carousel_id] %>
<% total_slides = local_assigns[:total_slides] || 0 %>
<% produit = local_assigns[:produit] %>

<% if show_thumbnails && total_slides > 1 %>
  <div class="mt-2 py-2">
    <div class="d-flex justify-content-center flex-nowrap gap-2 overflow-x-auto carousel-thumbnails">
      <% thumbnail_index = 0 %>
      
      <% if produit.video1.attached? %>
        <button type="button" class="carousel-thumbnail flex-shrink-0 <%= 'active' if thumbnail_index == 0 %> border-0 bg-transparent p-0" 
             data-bs-target="#<%= carousel_id %>"
             data-bs-slide-to="<%= thumbnail_index %>">
          <div class="position-relative">
            <video class="carousel-thumbnail-media" muted playsinline>
              <source src="<%= url_for(produit.video1) %>" type="<%= produit.video1.content_type %>">
            </video>
            <div class="position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center">
              <i class="bi bi-play-circle-fill text-white fs-4"></i>
            </div>
          </div>
        </button>
        <% thumbnail_index += 1 %>
        <button type="button" class="carousel-thumbnail flex-shrink-0 border-0 bg-transparent p-0" 
             data-bs-target="#<%= carousel_id %>"
             data-bs-slide-to="<%= thumbnail_index %>">
          <%= image_tag(produit.default_image_white, class: "carousel-thumbnail-media", alt: produit.nom) %>
        </button>
        <% thumbnail_index += 1 %>
      <% else %>
        <button type="button" class="carousel-thumbnail flex-shrink-0 active border-0 bg-transparent p-0" 
             data-bs-target="#<%= carousel_id %>"
             data-bs-slide-to="<%= thumbnail_index %>">
          <%= image_tag(produit.default_image_white, class: "carousel-thumbnail-media", alt: produit.nom) %>
        </button>
        <% thumbnail_index += 1 %>
      <% end %>

      <% if produit.images %>
        <% produit.images.each do |image| %>
          <button type="button" class="carousel-thumbnail flex-shrink-0 border-0 bg-transparent p-0" 
               data-bs-target="#<%= carousel_id %>"
               data-bs-slide-to="<%= thumbnail_index %>">
            <%= image_tag(image, class: "carousel-thumbnail-media", alt: produit.nom) %>
          </button>
          <% thumbnail_index += 1 %>
        <% end %>
      <% end %>
    </div>
  </div>
<% end %>

